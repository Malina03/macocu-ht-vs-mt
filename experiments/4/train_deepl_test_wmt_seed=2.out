Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/data/s4314719/.envs/py3.8.6_env/lib/python3.8/site-packages/setuptools/distutils_patch.py:25: UserWarning: Distutils was imported before Setuptools. This usage is discouraged and may exhibit undesirable behaviors or errors. Please use Setuptools' objects directly or at least import Setuptools first.
  warnings.warn(
***** Running Evaluation *****
  Num examples = 12000
  Batch size = 64
=> Loading train corpus...
=> Loading test corpus...
Testing on five WMT submissions:
 /data/pg-macocu/MT_vs_HT/experiments/4/data/wmt_submissions/test/newstest2019.online-X.0.wmt
/data/pg-macocu/MT_vs_HT/experiments/4/data/wmt_submissions/test/newstest2019.dfki-nmt.6478.wmt
/data/pg-macocu/MT_vs_HT/experiments/4/data/wmt_submissions/test/newstest2019.NEU.6801.wmt
/data/pg-macocu/MT_vs_HT/experiments/4/data/wmt_submissions/test/newstest2019.online-G.0.wmt
/data/pg-macocu/MT_vs_HT/experiments/4/data/wmt_submissions/test/newstest2019.online-B.0.wmt
Loading model at /data/pg-macocu/MT_vs_HT/experiments/4/models/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=2/checkpoint-2800
Generated by command:
python classifier_trf_hf.py --root_dir /data/pg-macocu/MT_vs_HT/experiments/4 --load_model /data/pg-macocu/MT_vs_HT/experiments/4/models/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=2/checkpoint-2800 --arch microsoft/deberta-v3-large --test wmt_submissions
Logging training settings
 TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_steps=200,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=True,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=1e-05,
length_column_name=length,
load_best_model_at_end=True,
local_rank=-1,
log_level=10,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/data/pg-macocu/MT_vs_HT/experiments/4/models/wmt_submissions/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1_test/runs/Feb10_10-40-22_pg-gpu07,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=200,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1,
max_steps=-1,
metric_for_best_model=accuracy,
mp_parameters=,
no_cuda=False,
num_train_epochs=10,
optim=OptimizerNames.ADAMW_HF,
output_dir=/data/pg-macocu/MT_vs_HT/experiments/4/models/wmt_submissions/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1_test,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=64,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['mlflow', 'tensorboard'],
resume_from_checkpoint=None,
run_name=/data/pg-macocu/MT_vs_HT/experiments/4/models/wmt_submissions/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1_test,
save_on_each_node=False,
save_steps=200,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=2,
seed=1,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=200,
weight_decay=0,
xpu_backend=None,
)
  0%|          | 0/188 [00:00<?, ?it/s]  1%|          | 2/188 [00:00<00:57,  3.26it/s]  2%|▏         | 3/188 [00:01<01:20,  2.29it/s]  2%|▏         | 4/188 [00:01<01:32,  1.98it/s]  3%|▎         | 5/188 [00:02<01:39,  1.83it/s]  3%|▎         | 6/188 [00:03<01:43,  1.75it/s]  4%|▎         | 7/188 [00:03<01:45,  1.71it/s]  4%|▍         | 8/188 [00:04<01:47,  1.68it/s]  5%|▍         | 9/188 [00:04<01:48,  1.66it/s]  5%|▌         | 10/188 [00:05<01:48,  1.64it/s]  6%|▌         | 11/188 [00:06<01:48,  1.63it/s]  6%|▋         | 12/188 [00:06<01:48,  1.63it/s]  7%|▋         | 13/188 [00:07<01:47,  1.62it/s]  7%|▋         | 14/188 [00:08<01:47,  1.62it/s]  8%|▊         | 15/188 [00:08<01:46,  1.62it/s]  9%|▊         | 16/188 [00:09<01:46,  1.62it/s]  9%|▉         | 17/188 [00:09<01:45,  1.62it/s] 10%|▉         | 18/188 [00:10<01:44,  1.62it/s] 10%|█         | 19/188 [00:11<01:44,  1.62it/s] 11%|█         | 20/188 [00:11<01:43,  1.63it/s] 11%|█         | 21/188 [00:12<01:42,  1.63it/s] 12%|█▏        | 22/188 [00:12<01:41,  1.63it/s] 12%|█▏        | 23/188 [00:13<01:41,  1.63it/s] 13%|█▎        | 24/188 [00:14<01:40,  1.63it/s] 13%|█▎        | 25/188 [00:14<01:39,  1.63it/s] 14%|█▍        | 26/188 [00:15<01:39,  1.63it/s] 14%|█▍        | 27/188 [00:16<01:38,  1.63it/s] 15%|█▍        | 28/188 [00:16<01:38,  1.63it/s] 15%|█▌        | 29/188 [00:17<01:37,  1.63it/s] 16%|█▌        | 30/188 [00:17<01:36,  1.63it/s] 16%|█▋        | 31/188 [00:18<01:36,  1.63it/s] 17%|█▋        | 32/188 [00:19<01:35,  1.63it/s] 18%|█▊        | 33/188 [00:19<01:35,  1.63it/s] 18%|█▊        | 34/188 [00:20<01:34,  1.63it/s] 19%|█▊        | 35/188 [00:20<01:33,  1.63it/s] 19%|█▉        | 36/188 [00:21<01:33,  1.63it/s] 20%|█▉        | 37/188 [00:22<01:32,  1.63it/s] 20%|██        | 38/188 [00:22<01:32,  1.63it/s] 21%|██        | 39/188 [00:23<01:31,  1.63it/s] 21%|██▏       | 40/188 [00:24<01:30,  1.63it/s] 22%|██▏       | 41/188 [00:24<01:30,  1.63it/s] 22%|██▏       | 42/188 [00:25<01:29,  1.63it/s] 23%|██▎       | 43/188 [00:25<01:28,  1.63it/s] 23%|██▎       | 44/188 [00:26<01:28,  1.63it/s] 24%|██▍       | 45/188 [00:27<01:27,  1.63it/s] 24%|██▍       | 46/188 [00:27<01:27,  1.63it/s] 25%|██▌       | 47/188 [00:28<01:26,  1.63it/s] 26%|██▌       | 48/188 [00:28<01:25,  1.63it/s] 26%|██▌       | 49/188 [00:29<01:25,  1.63it/s] 27%|██▋       | 50/188 [00:30<01:24,  1.63it/s] 27%|██▋       | 51/188 [00:30<01:23,  1.63it/s] 28%|██▊       | 52/188 [00:31<01:23,  1.63it/s] 28%|██▊       | 53/188 [00:31<01:22,  1.63it/s] 29%|██▊       | 54/188 [00:32<01:22,  1.63it/s] 29%|██▉       | 55/188 [00:33<01:21,  1.63it/s] 30%|██▉       | 56/188 [00:33<01:21,  1.63it/s] 30%|███       | 57/188 [00:34<01:20,  1.63it/s] 31%|███       | 58/188 [00:35<01:19,  1.63it/s] 31%|███▏      | 59/188 [00:35<01:19,  1.63it/s] 32%|███▏      | 60/188 [00:36<01:18,  1.63it/s] 32%|███▏      | 61/188 [00:36<01:17,  1.63it/s] 33%|███▎      | 62/188 [00:37<01:17,  1.63it/s] 34%|███▎      | 63/188 [00:38<01:16,  1.63it/s] 34%|███▍      | 64/188 [00:38<01:16,  1.63it/s] 35%|███▍      | 65/188 [00:39<01:15,  1.63it/s] 35%|███▌      | 66/188 [00:39<01:14,  1.63it/s] 36%|███▌      | 67/188 [00:40<01:14,  1.63it/s] 36%|███▌      | 68/188 [00:41<01:13,  1.63it/s] 37%|███▋      | 69/188 [00:41<01:12,  1.63it/s] 37%|███▋      | 70/188 [00:42<01:12,  1.63it/s] 38%|███▊      | 71/188 [00:43<01:11,  1.63it/s] 38%|███▊      | 72/188 [00:43<01:11,  1.63it/s] 39%|███▉      | 73/188 [00:44<01:10,  1.63it/s] 39%|███▉      | 74/188 [00:44<01:09,  1.63it/s] 40%|███▉      | 75/188 [00:45<01:09,  1.63it/s] 40%|████      | 76/188 [00:46<01:08,  1.63it/s] 41%|████      | 77/188 [00:46<01:08,  1.63it/s] 41%|████▏     | 78/188 [00:47<01:07,  1.63it/s] 42%|████▏     | 79/188 [00:47<01:06,  1.63it/s] 43%|████▎     | 80/188 [00:48<01:06,  1.63it/s] 43%|████▎     | 81/188 [00:49<01:05,  1.63it/s] 44%|████▎     | 82/188 [00:49<01:05,  1.63it/s] 44%|████▍     | 83/188 [00:50<01:04,  1.63it/s] 45%|████▍     | 84/188 [00:51<01:03,  1.63it/s] 45%|████▌     | 85/188 [00:51<01:03,  1.63it/s] 46%|████▌     | 86/188 [00:52<01:02,  1.63it/s] 46%|████▋     | 87/188 [00:52<01:01,  1.63it/s] 47%|████▋     | 88/188 [00:53<01:01,  1.63it/s] 47%|████▋     | 89/188 [00:54<01:00,  1.63it/s] 48%|████▊     | 90/188 [00:54<01:00,  1.63it/s] 48%|████▊     | 91/188 [00:55<00:59,  1.63it/s] 49%|████▉     | 92/188 [00:55<00:58,  1.63it/s] 49%|████▉     | 93/188 [00:56<00:58,  1.63it/s] 50%|█████     | 94/188 [00:57<00:57,  1.63it/s] 51%|█████     | 95/188 [00:57<00:57,  1.63it/s] 51%|█████     | 96/188 [00:58<00:56,  1.63it/s] 52%|█████▏    | 97/188 [00:59<00:55,  1.63it/s] 52%|█████▏    | 98/188 [00:59<00:55,  1.63it/s] 53%|█████▎    | 99/188 [01:00<00:54,  1.63it/s] 53%|█████▎    | 100/188 [01:00<00:53,  1.63it/s] 54%|█████▎    | 101/188 [01:01<00:53,  1.63it/s] 54%|█████▍    | 102/188 [01:02<00:52,  1.63it/s] 55%|█████▍    | 103/188 [01:02<00:52,  1.63it/s] 55%|█████▌    | 104/188 [01:03<00:51,  1.63it/s] 56%|█████▌    | 105/188 [01:03<00:50,  1.63it/s] 56%|█████▋    | 106/188 [01:04<00:50,  1.63it/s] 57%|█████▋    | 107/188 [01:05<00:49,  1.63it/s] 57%|█████▋    | 108/188 [01:05<00:49,  1.63it/s] 58%|█████▊    | 109/188 [01:06<00:48,  1.63it/s] 59%|█████▊    | 110/188 [01:06<00:47,  1.63it/s] 59%|█████▉    | 111/188 [01:07<00:47,  1.63it/s] 60%|█████▉    | 112/188 [01:08<00:46,  1.63it/s] 60%|██████    | 113/188 [01:08<00:46,  1.63it/s] 61%|██████    | 114/188 [01:09<00:45,  1.63it/s] 61%|██████    | 115/188 [01:10<00:44,  1.63it/s] 62%|██████▏   | 116/188 [01:10<00:44,  1.62it/s] 62%|██████▏   | 117/188 [01:11<00:43,  1.62it/s] 63%|██████▎   | 118/188 [01:11<00:43,  1.62it/s] 63%|██████▎   | 119/188 [01:12<00:42,  1.62it/s] 64%|██████▍   | 120/188 [01:13<00:41,  1.62it/s] 64%|██████▍   | 121/188 [01:13<00:41,  1.62it/s] 65%|██████▍   | 122/188 [01:14<00:40,  1.62it/s] 65%|██████▌   | 123/188 [01:14<00:39,  1.63it/s] 66%|██████▌   | 124/188 [01:15<00:39,  1.63it/s] 66%|██████▋   | 125/188 [01:16<00:38,  1.63it/s] 67%|██████▋   | 126/188 [01:16<00:38,  1.62it/s] 68%|██████▊   | 127/188 [01:17<00:37,  1.62it/s] 68%|██████▊   | 128/188 [01:18<00:36,  1.63it/s] 69%|██████▊   | 129/188 [01:18<00:36,  1.62it/s] 69%|██████▉   | 130/188 [01:19<00:35,  1.62it/s] 70%|██████▉   | 131/188 [01:19<00:35,  1.62it/s] 70%|███████   | 132/188 [01:20<00:34,  1.63it/s] 71%|███████   | 133/188 [01:21<00:33,  1.63it/s] 71%|███████▏  | 134/188 [01:21<00:33,  1.63it/s] 72%|███████▏  | 135/188 [01:22<00:32,  1.62it/s] 72%|███████▏  | 136/188 [01:22<00:32,  1.62it/s] 73%|███████▎  | 137/188 [01:23<00:31,  1.62it/s] 73%|███████▎  | 138/188 [01:24<00:30,  1.62it/s] 74%|███████▍  | 139/188 [01:24<00:30,  1.62it/s] 74%|███████▍  | 140/188 [01:25<00:29,  1.62it/s] 75%|███████▌  | 141/188 [01:26<00:28,  1.63it/s] 76%|███████▌  | 142/188 [01:26<00:28,  1.62it/s] 76%|███████▌  | 143/188 [01:27<00:27,  1.62it/s] 77%|███████▋  | 144/188 [01:27<00:27,  1.63it/s] 77%|███████▋  | 145/188 [01:28<00:26,  1.62it/s] 78%|███████▊  | 146/188 [01:29<00:25,  1.62it/s] 78%|███████▊  | 147/188 [01:29<00:25,  1.62it/s] 79%|███████▊  | 148/188 [01:30<00:24,  1.62it/s] 79%|███████▉  | 149/188 [01:30<00:23,  1.63it/s] 80%|███████▉  | 150/188 [01:31<00:23,  1.62it/s] 80%|████████  | 151/188 [01:32<00:22,  1.62it/s] 81%|████████  | 152/188 [01:32<00:22,  1.62it/s] 81%|████████▏ | 153/188 [01:33<00:21,  1.62it/s] 82%|████████▏ | 154/188 [01:34<00:20,  1.63it/s] 82%|████████▏ | 155/188 [01:34<00:20,  1.62it/s] 83%|████████▎ | 156/188 [01:35<00:19,  1.62it/s] 84%|████████▎ | 157/188 [01:35<00:19,  1.62it/s] 84%|████████▍ | 158/188 [01:36<00:18,  1.62it/s] 85%|████████▍ | 159/188 [01:37<00:17,  1.62it/s] 85%|████████▌ | 160/188 [01:37<00:17,  1.62it/s] 86%|████████▌ | 161/188 [01:38<00:16,  1.62it/s] 86%|████████▌ | 162/188 [01:39<00:16,  1.62it/s] 87%|████████▋ | 163/188 [01:39<00:15,  1.62it/s] 87%|████████▋ | 164/188 [01:40<00:14,  1.62it/s] 88%|████████▊ | 165/188 [01:40<00:14,  1.62it/s] 88%|████████▊ | 166/188 [01:41<00:13,  1.62it/s] 89%|████████▉ | 167/188 [01:42<00:12,  1.62it/s] 89%|████████▉ | 168/188 [01:42<00:12,  1.62it/s] 90%|████████▉ | 169/188 [01:43<00:11,  1.62it/s] 90%|█████████ | 170/188 [01:43<00:11,  1.62it/s] 91%|█████████ | 171/188 [01:44<00:10,  1.62it/s] 91%|█████████▏| 172/188 [01:45<00:09,  1.62it/s] 92%|█████████▏| 173/188 [01:45<00:09,  1.62it/s] 93%|█████████▎| 174/188 [01:46<00:08,  1.62it/s] 93%|█████████▎| 175/188 [01:47<00:08,  1.62it/s] 94%|█████████▎| 176/188 [01:47<00:07,  1.62it/s] 94%|█████████▍| 177/188 [01:48<00:06,  1.62it/s] 95%|█████████▍| 178/188 [01:48<00:06,  1.62it/s] 95%|█████████▌| 179/188 [01:49<00:05,  1.62it/s] 96%|█████████▌| 180/188 [01:50<00:04,  1.62it/s] 96%|█████████▋| 181/188 [01:50<00:04,  1.62it/s] 97%|█████████▋| 182/188 [01:51<00:03,  1.62it/s] 97%|█████████▋| 183/188 [01:51<00:03,  1.62it/s] 98%|█████████▊| 184/188 [01:52<00:02,  1.62it/s] 98%|█████████▊| 185/188 [01:53<00:01,  1.62it/s] 99%|█████████▉| 186/188 [01:53<00:01,  1.62it/s] 99%|█████████▉| 187/188 [01:54<00:00,  1.62it/s]100%|██████████| 188/188 [01:54<00:00,  1.89it/s]100%|██████████| 188/188 [01:56<00:00,  1.61it/s]

Info:
 {'eval_loss': 1.094422459602356, 'eval_accuracy': 0.6215833333333334, 'eval_f1': 0.5267834678054664, 'eval_precision': 0.5479186048423464, 'eval_recall': 0.58175, 'eval_runtime': 115.3953, 'eval_samples_per_second': 103.99, 'eval_steps_per_second': 1.629}
