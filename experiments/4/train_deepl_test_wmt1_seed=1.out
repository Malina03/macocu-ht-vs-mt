Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
/data/s4314719/.envs/py3.8.6_env/lib/python3.8/site-packages/setuptools/distutils_patch.py:25: UserWarning: Distutils was imported before Setuptools. This usage is discouraged and may exhibit undesirable behaviors or errors. Please use Setuptools' objects directly or at least import Setuptools first.
  warnings.warn(
***** Running Evaluation *****
  Num examples = 4000
  Batch size = 64
=> Loading train corpus...
=> Loading test corpus...
Loading model at /data/pg-macocu/MT_vs_HT/experiments/4/models/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1/checkpoint-1800
Generated by command:
python classifier_trf_hf.py --root_dir /data/pg-macocu/MT_vs_HT/experiments/4 --load_model /data/pg-macocu/MT_vs_HT/experiments/4/models/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1/checkpoint-1800 --arch microsoft/deberta-v3-large --test wmt1
Logging training settings
 TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=False,
eval_accumulation_steps=None,
eval_steps=200,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=True,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=1e-05,
length_column_name=length,
load_best_model_at_end=True,
local_rank=-1,
log_level=10,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/data/pg-macocu/MT_vs_HT/experiments/4/models/wmt1/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1_test/runs/Feb17_17-06-21_pg-gpu33,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=200,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1,
max_steps=-1,
metric_for_best_model=accuracy,
mp_parameters=,
no_cuda=False,
num_train_epochs=10,
optim=OptimizerNames.ADAMW_HF,
output_dir=/data/pg-macocu/MT_vs_HT/experiments/4/models/wmt1/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1_test,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=64,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['mlflow', 'tensorboard'],
resume_from_checkpoint=None,
run_name=/data/pg-macocu/MT_vs_HT/experiments/4/models/wmt1/microsoft-deberta-v3-large_lr=1e-05_bsz=32_seed=1_test,
save_on_each_node=False,
save_steps=200,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=2,
seed=1,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=200,
weight_decay=0,
xpu_backend=None,
)
  0%|          | 0/63 [00:00<?, ?it/s]  3%|▎         | 2/63 [00:00<00:18,  3.29it/s]  5%|▍         | 3/63 [00:01<00:25,  2.33it/s]  6%|▋         | 4/63 [00:01<00:29,  2.02it/s]  8%|▊         | 5/63 [00:02<00:30,  1.87it/s] 10%|▉         | 6/63 [00:03<00:31,  1.79it/s] 11%|█         | 7/63 [00:03<00:32,  1.74it/s] 13%|█▎        | 8/63 [00:04<00:32,  1.71it/s] 14%|█▍        | 9/63 [00:04<00:31,  1.69it/s] 16%|█▌        | 10/63 [00:05<00:31,  1.68it/s] 17%|█▋        | 11/63 [00:06<00:31,  1.67it/s] 19%|█▉        | 12/63 [00:06<00:30,  1.66it/s] 21%|██        | 13/63 [00:07<00:30,  1.66it/s] 22%|██▏       | 14/63 [00:07<00:29,  1.66it/s] 24%|██▍       | 15/63 [00:08<00:29,  1.65it/s] 25%|██▌       | 16/63 [00:09<00:28,  1.65it/s] 27%|██▋       | 17/63 [00:09<00:27,  1.65it/s] 29%|██▊       | 18/63 [00:10<00:27,  1.65it/s] 30%|███       | 19/63 [00:10<00:26,  1.65it/s] 32%|███▏      | 20/63 [00:11<00:26,  1.65it/s] 33%|███▎      | 21/63 [00:12<00:25,  1.65it/s] 35%|███▍      | 22/63 [00:12<00:24,  1.65it/s] 37%|███▋      | 23/63 [00:13<00:24,  1.65it/s] 38%|███▊      | 24/63 [00:13<00:23,  1.65it/s] 40%|███▉      | 25/63 [00:14<00:23,  1.65it/s] 41%|████▏     | 26/63 [00:15<00:22,  1.65it/s] 43%|████▎     | 27/63 [00:15<00:21,  1.65it/s] 44%|████▍     | 28/63 [00:16<00:21,  1.65it/s] 46%|████▌     | 29/63 [00:16<00:20,  1.65it/s] 48%|████▊     | 30/63 [00:17<00:20,  1.65it/s] 49%|████▉     | 31/63 [00:18<00:19,  1.65it/s] 51%|█████     | 32/63 [00:18<00:20,  1.51it/s] 52%|█████▏    | 33/63 [00:19<00:19,  1.55it/s] 54%|█████▍    | 34/63 [00:20<00:18,  1.58it/s] 56%|█████▌    | 35/63 [00:20<00:17,  1.60it/s] 57%|█████▋    | 36/63 [00:21<00:16,  1.61it/s] 59%|█████▊    | 37/63 [00:22<00:16,  1.62it/s] 60%|██████    | 38/63 [00:22<00:15,  1.63it/s] 62%|██████▏   | 39/63 [00:23<00:14,  1.64it/s] 63%|██████▎   | 40/63 [00:23<00:14,  1.64it/s] 65%|██████▌   | 41/63 [00:24<00:13,  1.64it/s] 67%|██████▋   | 42/63 [00:25<00:12,  1.65it/s] 68%|██████▊   | 43/63 [00:25<00:12,  1.65it/s] 70%|██████▉   | 44/63 [00:26<00:11,  1.65it/s] 71%|███████▏  | 45/63 [00:26<00:10,  1.65it/s] 73%|███████▎  | 46/63 [00:27<00:10,  1.65it/s] 75%|███████▍  | 47/63 [00:28<00:09,  1.65it/s] 76%|███████▌  | 48/63 [00:28<00:09,  1.65it/s] 78%|███████▊  | 49/63 [00:29<00:08,  1.65it/s] 79%|███████▉  | 50/63 [00:29<00:07,  1.65it/s] 81%|████████  | 51/63 [00:30<00:07,  1.65it/s] 83%|████████▎ | 52/63 [00:31<00:06,  1.65it/s] 84%|████████▍ | 53/63 [00:31<00:06,  1.65it/s] 86%|████████▌ | 54/63 [00:32<00:05,  1.65it/s] 87%|████████▋ | 55/63 [00:32<00:04,  1.65it/s] 89%|████████▉ | 56/63 [00:33<00:04,  1.65it/s] 90%|█████████ | 57/63 [00:34<00:03,  1.65it/s] 92%|█████████▏| 58/63 [00:34<00:03,  1.65it/s] 94%|█████████▎| 59/63 [00:35<00:02,  1.65it/s] 95%|█████████▌| 60/63 [00:35<00:01,  1.65it/s] 97%|█████████▋| 61/63 [00:36<00:01,  1.65it/s] 98%|█████████▊| 62/63 [00:37<00:00,  1.64it/s]100%|██████████| 63/63 [00:37<00:00,  1.92it/s]100%|██████████| 63/63 [00:41<00:00,  1.52it/s]

Info:
 {'eval_loss': 0.7216125726699829, 'eval_accuracy': 0.60375, 'eval_f1': 0.5782811043793512, 'eval_precision': 0.6367961549402695, 'eval_recall': 0.60375, 'eval_runtime': 38.6663, 'eval_samples_per_second': 103.449, 'eval_steps_per_second': 1.629}
